<?php
/**
 * Created by PhpStorm.
 * User: kbworkingpro
 * Date: 2019/4/3
 * Time: 11:23 AM
 */

namespace util\validate;

/**
 * Class PhoneCheck
 */
class PhoneCheck
{

    /**
     * 分割符(不支持数字和横杠，其他字符可扩展)
     *
     * @var string
     */
    static public $segmentChar = '/[,;，；、\|]/';

    /**
     * 移动电话1开头
     *
     * @var string
     */
    static public $mobilePattern = '/(?<phone>(?:1[3-9](\d[-|\s]?){6}\d{3}))/';

    /**
     * 固定电话01|02开头
     *
     * @var string
     */
    static public $telPattern02 = '/(?<phone>(?:0[12]\d[-|\s]?\d{8}([-|\s]?\d{1,4})?))/';

    /**
     * 固定电话非01|02开头
     *
     * @var string
     */
    static public $telPattern03 = '/(?<phone>(?:0[^12]\d{2}[-|\s]?\d{7,8}([-|\s]?\d{1,4})?))/';

    /**
     * 企业电话400|800
     *
     * @var string
     */
    static public $corpPattern = '/(?<phone>(?:[4|8]00[-|\s]?(\d[-|\s]?){4}[-|\s]?\d{3}))/';

    /**
     * Config Key
     *
     * @var string
     */
    static private $logKey = 'validate:tel:warning';

    /**
     * Tel Rules
     *
     * @var array
     */
    static private $telRules = ['010'  => 8,'021'  => 8,'022'  => 8,'023'  => 8,'024'  => 8,'025'  => 8,'027'  => 8,
        '028'  => 8,'029'  => 8,'020'  => 8,'0312' => 7,'0313' => 7,'0311' => 8,'0314' => 7,'0315' => 7,'0316' => 7,
        '0317' => 7,'0319' => 7,'0318' => 7,'0310' => 7,'0349' => 7,'0335' => 7, '0351' => 7,'0352' => 7,'0353' => 7,
        '0354' => 7,'0356' => 7,'0355' => 7,'0357' => 7,'0358' => 7,'0350' => 7,'0371' => 8,'0359' => 7,'0372' => 7,
        '0373' => 7,'0375' => 7,'0374' => 7,'0377' => 8,'0376' => 7,'0379' => 8,'0370' => 7,'0391' => 7,'0392' => 7,
        '0393' => 7,'0394' => 7,'0395' => 7, '0396' => 7,'0398' => 7,'0412' => 7,'0411' => 8,'0416' => 7,'0415' => 7,
        '0417' => 7,'0418' => 7,'0419' => 7,'0421' => 7,'0427' => 7,'0429' => 7,'0431' => 8,'0432' => 8,'0433' => 7,
        '0434' => 7,'0435' => 7,'0436' => 7,'0437' => 7,'0438' => 7,'0439' => 7,'0451' => 8,'0453' => 7,'0452' => 7,
        '0454' => 7,'0455' => 7,'0456' => 7,'0458' => 7,'0457' => 7,'0459' => 7,'0464' => 7,'0467' => 7,'0469' => 7,
        '0468' => 7,'0471' => 7,'0472' => 7,'0473' => 7,'0475' => 7,'0474' => 7,'0476' => 7,'0477' => 7,'0478' => 7,
        '0470' => 7,'0479' => 7,'0482' => 7,'0483' => 7,'0511' => 8,'0512' => 8,'0513' => 8,'0514' => 8,'0515' => 8,
        '0516' => 8,'0517' => 8,'0518' => 8,'0519' => 8,'0510' => 8,'0523' => 8,'0527' => 8,'0531' => 8,'0532' => 8,
        '0533' => 7,'0534' => 7,'0535' => 7,'0536' => 7,'0538' => 7,'0537' => 7,'0539' => 7,'0530' => 7,'0543' => 7,
        '0631' => 7,'0546' => 7,'0632' => 7,'0633' => 7,'0634' => 7,'0551' => 8,'0635' => 7,'0552' => 7,'0554' => 7,
        '0553' => 7,'0556' => 7,'0555' => 7,'0557' => 7,'0558' => 7,'0559' => 7,'0550' => 7,'0561' => 7,'0562' => 7,
        '0564' => 7,'0563' => 7,'0566' => 7,'0571' => 8,'0572' => 7,'0574' => 8,'0573' => 8,'0576' => 8,'0575' => 8,
        '0577' => 8,'0579' => 8,'0578' => 7,'0570' => 7,'0580' => 7,'0591' => 8,'0592' => 7,'0593' => 7,'0594' => 7,
        '0595' => 8,'0596' => 7,'0597' => 7,'0598' => 7,'0599' => 7,'0662' => 7,'0663' => 7,'0668' => 7,'0660' => 7,
        '0691' => 7,'0692' => 7,'0711' => 7,'0712' => 7,'0713' => 7,'0714' => 7,'0715' => 7,'0716' => 7,'0717' => 7,
        '0718' => 7,'0710' => 7,'0719' => 7,'0722' => 7,'0724' => 7,'0728' => 7,'0731' => 8,'0734' => 7,'0735' => 7,
        '0736' => 7,'0737' => 7,'0738' => 7,'0739' => 7,'0730' => 7,'0743' => 7,'0744' => 7,'0745' => 7,'0746' => 7,
        '0751' => 7,'0752' => 7,'0753' => 7,'0754' => 8,'0755' => 8,'0756' => 7,'0757' => 8,'0758' => 7,'0759' => 7,
        '0750' => 7,'0763' => 7,'0762' => 7,'0766' => 7,'0768' => 7,'0769' => 8,'0760' => 8,'0771' => 7,'0772' => 7,
        '0773' => 7,'0774' => 7,'0775' => 7,'0776' => 7,'0777' => 7,'0778' => 7,'0779' => 7,'0791' => 8,'0770' => 7,
        '0792' => 7,'0793' => 7,'0794' => 7,'0795' => 7,'0796' => 7,'0797' => 7,'0798' => 7,'0799' => 7,'0701' => 7,
        '0790' => 7,'0812' => 7,'0813' => 7,'0816' => 7,'0817' => 7,'0818' => 7,'0825' => 7,'0826' => 7,'0827' => 7,
        '0831' => 7,'0832' => 7,'0833' => 7,'0834' => 7,'0837' => 7,'0835' => 7,'0836' => 7,'0838' => 7,'0839' => 7,
        '0830' => 7,'0851' => 8,'0854' => 7,'0855' => 7,'0856' => 7,'0857' => 7,'0858' => 7,'0859' => 7,'0871' => 8,
        '0872' => 7,'0874' => 7,'0873' => 7,'0875' => 7,'0876' => 7,'0877' => 7,'0879' => 7,'0878' => 7,'0870' => 7,
        '0883' => 7,'0886' => 7,'0887' => 7,'0888' => 7,'0891' => 7,'0892' => 7,'0893' => 7,'0894' => 7,'0895' => 7,
        '0896' => 7,'0897' => 7,'0898' => 8,'0911' => 7,'0912' => 7,'0913' => 7,'0914' => 7,'0915' => 7,'0916' => 7,
        '0917' => 7,'0919' => 7,'0931' => 7,'0932' => 7,'0933' => 7,'0934' => 7,'0936' => 7,'0935' => 7,'0937' => 7,
        '0938' => 7,'0939' => 7,'0930' => 7,'0941' => 7,'0943' => 7,'0951' => 7,'0953' => 7,'0952' => 7,'0955' => 7,
        '0954' => 7,'0971' => 7,'0972' => 7,'0973' => 7,'0974' => 7,'0976' => 7,'0975' => 7,'0977' => 7,'0979' => 7,
        '0970' => 7,'0992' => 7,'0991' => 7,'0993' => 7,'0994' => 7,'0995' => 7,'0997' => 7,'0996' => 7,'0998' => 7,
        '0999' => 7,'0901' => 7,'0990' => 7,'0902' => 7,'0903' => 7,'0906' => 7,'0909' => 7,'0908' => 7];

    /**
     * City Code
     *
     * @var array
     */
    static private $cityCode = ['上海市' => '021','上海' => '021','杭州市' => '0571','杭州' => '0571','南京市' => '025','南京' => '025','宁波市' => '0574','宁波' => '0574','温州市' => '0577','温州' => '0577','嘉兴市' => '0573','嘉兴' => '0573','湖州市' => '0572','湖州' => '0572','绍兴市' => '0575','绍兴' => '0575','金华市' => '0579','金华' => '0579','衢州市' => '0570','衢州' => '0570','舟山市' => '0580',
        '舟山' => '0580','台州市' => '0576','台州' => '0576','丽水市' => '0578','丽水' => '0578','无锡市' => '0510','无锡' => '0510','徐州市' => '0516','徐州' => '0516','常州市' => '0519','常州' => '0519','苏州市' => '0512','苏州' => '0512','南通市' => '0513','南通' => '0513','连云港市' => '0518','连云港' => '0518','淮安市' => '0517','淮安' => '0517','盐城市' => '0515','盐城' => '0515',
        '扬州市' => '0514','扬州' => '0514','镇江市' => '0511','镇江' => '0511','泰州市' => '0523','泰州' => '0523','宿迁市' => '0527','宿迁' => '0527','合肥市' => '0551','合肥' => '0551','芜湖市' => '0553','芜湖' => '0553','蚌埠市' => '0552','蚌埠' => '0552','淮南市' => '0554','淮南' => '0554','马鞍山市' => '0555','马鞍山' => '0555','淮北市' => '0561','淮北' => '0561','铜陵市' => '0562',
        '铜陵' => '0562','安庆市' => '0556','安庆' => '0556','黄山市' => '0559','黄山' => '0559','滁州市' => '0550','滁州' => '0550','阜阳市' => '0558','阜阳' => '0558','宿州市' => '0557','宿州' => '0557','六安市' => '0564','六安' => '0564','亳州市' => '0558','亳州' => '0558','池州市' => '0566','池州' => '0566','宣城市' => '0563','宣城' => '0563','北京市' => '010','北京' => '010',
        '天津市' => '022','天津' => '022','石家庄市' => '0311','石家庄' => '0311','济南市' => '0531','济南' => '0531','青岛市' => '0532','青岛' => '0532','南昌市' => '0791','南昌' => '0791','九江市' => '0792','九江' => '0792','福州市' => '0591','福州' => '0591','厦门市' => '0592','厦门' => '0592','郑州市' => '0371','郑州' => '0371','武汉市' => '027','武汉' => '027','长沙市' => '0731',
        '长沙' => '0731','南宁市' => '0771','南宁' => '0771','桂林市' => '0773','桂林' => '0773','重庆市' => '023','重庆' => '023','成都市' => '028','成都' => '028','贵阳市' => '0851','贵阳' => '0851','昆明市' => '0871','昆明' => '0871','广州市' => '020','广州' => '020','韶关市' => '0751','韶关' => '0751','深圳市' => '0755','深圳' => '0755','珠海市' => '0756','珠海' => '0756',
        '汕头市' => '0754','汕头' => '0754','佛山市' => '0757','佛山' => '0757','江门市' => '0750','江门' => '0750','湛江市' => '0759','湛江' => '0759','茂名市' => '0668','茂名' => '0668','肇庆市' => '0758','肇庆' => '0758','惠州市' => '0752','惠州' => '0752','梅州市' => '0753','梅州' => '0753','汕尾市' => '0660','汕尾' => '0660','河源市' => '0762','河源' => '0762','阳江市' => '0662',
        '阳江' => '0662','清远市' => '0763','清远' => '0763','东莞市' => '0769','东莞' => '0769','中山市' => '0760','中山' => '0760','潮州市' => '0768','潮州' => '0768','揭阳市' => '0663','揭阳' => '0663','云浮市' => '0766','云浮' => '0766','海口市' => '0898','海口' => '0898','三亚市' => '0898','三亚' => '0898','太原市' => '0351','太原' => '0351','大同市' => '0352','大同' => '0352',
        '阳泉市' => '0353','阳泉' => '0353','长治市' => '0355','长治' => '0355','晋城市' => '0356','晋城' => '0356','朔州市' => '0349','朔州' => '0349','晋中市' => '0354','晋中' => '0354','运城市' => '0359','运城' => '0359','临汾市' => '0357','临汾' => '0357','莆田市' => '0594','莆田' => '0594','三明市' => '0598','三明' => '0598','泉州市' => '0595','泉州' => '0595','漳州市' => '0596',
        '漳州' => '0596','南平市' => '0599','南平' => '0599','龙岩市' => '0597','龙岩' => '0597','宁德市' => '0593','宁德' => '0593','柳州市' => '0772','柳州' => '0772','梧州市' => '0774','梧州' => '0774','北海市' => '0779','北海' => '0779','防城港市' => '0770','防城港' => '0770','钦州市' => '0777','钦州' => '0777','贵港市' => '0775','贵港' => '0775','玉林市' => '0775','玉林' => '0775',
        '百色市' => '0776','百色' => '0776','贺州市' => '0774','贺州' => '0774','河池市' => '0778','河池' => '0778','来宾市' => '0772','来宾' => '0772','崇左市' => '0771','崇左' => '0771','曲靖市' => '0874','曲靖' => '0874','玉溪市' => '0877','玉溪' => '0877','昭通市' => '0870','昭通' => '0870','丽江市' => '0888','丽江' => '0888','自贡市' => '0813','自贡' => '0813','攀枝花市' => '0812',
        '攀枝花' => '0812','泸州市' => '0830','泸州' => '0830','德阳市' => '0838','德阳' => '0838','绵阳市' => '0816','绵阳' => '0816','广元市' => '0839','广元' => '0839','遂宁市' => '0825','遂宁' => '0825','内江市' => '0832','内江' => '0832','乐山市' => '0833','乐山' => '0833','南充市' => '0817','南充' => '0817','眉山市' => '028','眉山' => '028','宜宾市' => '0831','宜宾' => '0831',
        '广安市' => '0826','广安' => '0826','达州市' => '0818','达州' => '0818','雅安市' => '0835','雅安' => '0835','巴中市' => '0827','巴中' => '0827','资阳市' => '028','资阳' => '028','唐山市' => '0315','唐山' => '0315','秦皇岛市' => '0335','秦皇岛' => '0335','邯郸市' => '0310','邯郸' => '0310','邢台市' => '0319','邢台' => '0319','保定市' => '0312','保定' => '0312','承德市' => '0314',
        '承德' => '0314','沧州市' => '0317','沧州' => '0317','廊坊市' => '0316','廊坊' => '0316','衡水市' => '0318','衡水' => '0318','开封市' => '0371','开封' => '0371','洛阳市' => '0379','洛阳' => '0379','平顶山市' => '0375','平顶山' => '0375','安阳市' => '0372','安阳' => '0372','鹤壁市' => '0392','鹤壁' => '0392','新乡市' => '0373','新乡' => '0373','焦作市' => '0391','焦作' => '0391',
        '濮阳市' => '0393','濮阳' => '0393','许昌市' => '0374','许昌' => '0374','漯河市' => '0395','漯河' => '0395','三门峡市' => '0398','三门峡' => '0398','南阳市' => '0377','南阳' => '0377','商丘市' => '0370','商丘' => '0370','信阳市' => '0376','信阳' => '0376','周口市' => '0394','周口' => '0394','驻马店市' => '0396','驻马店' => '0396','黄石市' => '0714','黄石' => '0714','十堰市' => '0719',
        '十堰' => '0719','宜昌市' => '0717','宜昌' => '0717','鄂州市' => '0711','鄂州' => '0711','荆门市' => '0724','荆门' => '0724','孝感市' => '0712','孝感' => '0712','荆州市' => '0716','荆州' => '0716','黄冈市' => '0713','黄冈' => '0713','咸宁市' => '0715','咸宁' => '0715','随州市' => '0722','随州' => '0722','株洲市' => '0731','株洲' => '0731','湘潭市' => '0731','湘潭' => '0731',
        '衡阳市' => '0734','衡阳' => '0734','邵阳市' => '0739','邵阳' => '0739','岳阳市' => '0730','岳阳' => '0730','常德市' => '0736','常德' => '0736','张家界市' => '0744','张家界' => '0744','益阳市' => '0737','益阳' => '0737','郴州市' => '0735','郴州' => '0735','永州市' => '0746','永州' => '0746','怀化市' => '0745','怀化' => '0745','娄底市' => '0738','娄底' => '0738','湘西土家族苗族自治州' => '0743',
        '湘西' => '0743','湘西州' => '0743','湘西自治州' => '0743','景德镇市' => '0798','景德镇' => '0798','萍乡市' => '0799','萍乡' => '0799','新余市' => '0790','新余' => '0790','鹰潭市' => '0701','鹰潭' => '0701','赣州市' => '0797','赣州' => '0797','吉安市' => '0796','吉安' => '0796','宜春市' => '0795','宜春' => '0795','抚州市' => '0794','抚州' => '0794','上饶市' => '0793','上饶' => '0793',
        '淄博市' => '0533','淄博' => '0533','枣庄市' => '0632','枣庄' => '0632','东营市' => '0546','东营' => '0546','烟台市' => '0535','烟台' => '0535','潍坊市' => '0536','潍坊' => '0536','济宁市' => '0537','济宁' => '0537','泰安市' => '0538','泰安' => '0538','威海市' => '0631','威海' => '0631','日照市' => '0633','日照' => '0633','莱芜市' => '0634','莱芜' => '0634','临沂市' => '0539',
        '临沂' => '0539','德州市' => '0534','德州' => '0534','聊城市' => '0635','聊城' => '0635','滨州市' => '0543','滨州' => '0543','菏泽市' => '0530','菏泽' => '0530','兰州市' => '0931','兰州' => '0931','嘉峪关市' => '0937','嘉峪关' => '0937','金昌市' => '0935','金昌' => '0935','白银市' => '0943','白银' => '0943','天水市' => '0938','天水' => '0938','武威市' => '0935','武威' => '0935',
        '张掖市' => '0936','张掖' => '0936','平凉市' => '0933','平凉' => '0933','酒泉市' => '0937','酒泉' => '0937','庆阳市' => '0934','庆阳' => '0934','定西市' => '0932','定西' => '0932','银川市' => '0951','银川' => '0951','哈尔滨市' => '0451','哈尔滨' => '0451','齐齐哈尔市' => '0452','齐齐哈尔' => '0452','鸡西市' => '0467','鸡西' => '0467','鹤岗市' => '0468','鹤岗' => '0468','双鸭山市' => '0469',
        '双鸭山' => '0469','大庆市' => '0459','大庆' => '0459','伊春市' => '0458','伊春' => '0458','佳木斯市' => '0454','佳木斯' => '0454','牡丹江市' => '0453','牡丹江' => '0453','黑河市' => '0456','黑河' => '0456','绥化市' => '0455','绥化' => '0455','长春市' => '0431','长春' => '0431','吉林市' => '0432','吉林' => '0432','四平市' => '0434','四平' => '0434','辽源市' => '0437','辽源' => '0437',
        '通化市' => '0435','通化' => '0435','白山市' => '0439','白山' => '0439','松原市' => '0438','松原' => '0438','白城市' => '0436','白城' => '0436','延边朝鲜族自治州' => '0433','延边' => '0433','延边州' => '0433','延边自治州' => '0433','沈阳市' => '024','沈阳' => '024','大连市' => '0411','大连' => '0411','鞍山市' => '0412','鞍山' => '0412','抚顺市' => '024','抚顺' => '024','本溪市' => '024',
        '本溪' => '024','丹东市' => '0415','丹东' => '0415','锦州市' => '0416','锦州' => '0416','营口市' => '0417','营口' => '0417','阜新市' => '0418','阜新' => '0418','辽阳市' => '0419','辽阳' => '0419','盘锦市' => '0427','盘锦' => '0427','铁岭市' => '024','铁岭' => '024','朝阳市' => '0421','朝阳' => '0421','葫芦岛市' => '0429','葫芦岛' => '0429','呼和浩特市' => '0471','呼和浩特' => '0471',
        '包头市' => '0472','包头' => '0472','乌海市' => '0473','乌海' => '0473','赤峰市' => '0476','赤峰' => '0476','通辽市' => '0475','通辽' => '0475','呼伦贝尔市' => '0470','呼伦贝尔' => '0470','乌兰察布市' => '0474','乌兰察布' => '0474','兴安盟' => '0482','兴安' => '0482','锡林郭勒盟' => '0479','锡林郭勒' => '0479','西宁市' => '0971','西宁' => '0971','西安市' => '029','西安' => '029','铜川市' => '0919',
        '铜川' => '0919','宝鸡市' => '0917','宝鸡' => '0917','咸阳市' => '029','咸阳' => '029','渭南市' => '0913','渭南' => '0913','延安市' => '0911','延安' => '0911','汉中市' => '0916','汉中' => '0916','安康市' => '0915','安康' => '0915','六盘水市' => '0858','六盘水' => '0858','遵义市' => '0851','遵义' => '0851','安顺市' => '0851','安顺' => '0851','黔南布依族苗族自治州' => '0854','黔南' => '0854',
        '黔南州' => '0854','黔南自治州' => '0854','保山市' => '0875','保山' => '0875','临沧市' => '0883','临沧' => '0883','普洱市' => '0879','普洱' => '0879','思茅市' => '0879','张家口市' => '0313','张家口' => '0313','忻州市' => '0350','忻州' => '0350','吕梁市' => '0358','吕梁' => '0358','鄂尔多斯市' => '0477','鄂尔多斯' => '0477','巴彦淖尔市' => '0478','巴彦淖尔' => '0478','阿拉善盟' => '0483','阿拉善' => '0483',
        '七台河市' => '0464','七河' => '0464','大兴安岭地区' => '0457','大兴安岭' => '0457','襄阳市' => '0710','襄阳' => '0710','襄樊市' => '0710','恩施土家族苗族自治州' => '0718','恩施' => '0718','恩施州' => '0718','恩施自治州' => '0718','三沙市' => '0898','三沙' => '0898','阿坝藏族羌族自治州' => '0837','阿坝' => '0837','阿坝州' => '0837','阿坝自治州' => '0837','甘孜藏族自治州' => '0836','甘孜' => '0836','甘孜州' => '0836','甘孜自治州' => '0836',
        '凉山彝族自治州' => '0834','凉山' => '0834','凉山州' => '0834','凉山自治州' => '0834','毕节市' => '0857','毕节' => '0857','毕节地区' => '0857','铜仁市' => '0856','铜仁' => '0856','铜仁地区' => '0856','黔西南布依族苗族自治州' => '0859','黔西南' => '0859','黔西南州' => '0859','黔西南自治州' => '0859','黔东南苗族侗族自治州' => '0855','黔东南' => '0855','黔东南州' => '0855','黔东南自治州' => '0855','楚雄彝族自治州' => '0878','楚雄' => '0878','楚雄州' => '0878',
        '楚雄自治州' => '0878','红河哈尼族彝族自治州' => '0873','红河' => '0873','红河州' => '0873','红河自治州' => '0873','文山壮族苗族自治州' => '0876','文山' => '0876','文山州' => '0876','文山自治州' => '0876','西双版纳傣族自治州' => '0691','西双版纳' => '0691','西双版纳州' => '0691','西双版纳自治州' => '0691','大理白族自治州' => '0872','大理州' => '0872','大理自治州' => '0872','德宏傣族景颇族自治州' => '0692','德宏' => '0692','德宏州' => '0692','德宏自治州' => '0692','怒江傈僳族自治州' => '0886',
        '怒江' => '0886','怒江州' => '0886','怒江自治州' => '0886','迪庆藏族自治州' => '0887','迪庆' => '0887','迪庆州' => '0887','迪庆自治州' => '0887','拉萨市' => '0891','拉萨' => '0891','昌都市' => '0895','昌都' => '0895','昌都地区' => '0895','山南市' => '0893','山南' => '0893','山南地区' => '0893','日喀则市' => '0892','日喀则' => '0892','日喀则地区' => '0892','那曲市' => '0896','那曲' => '0896','那曲地区' => '0896',
        '阿里地区' => '0897','阿里' => '0897','林芝市' => '0894','林芝' => '0894','林芝地区' => '0894','林芝县' => '0894','榆林市' => '0912','榆林' => '0912','商洛市' => '0914','商洛' => '0914','陇南市' => '0939','陇南' => '0939','临夏回族自治州' => '0930','临夏' => '0930','临夏州' => '0930','临夏自治州' => '0930','甘南藏族自治州' => '0941','甘南' => '0941','甘南州' => '0941','甘南自治州' => '0941','石嘴山市' => '0952',
        '石嘴山' => '0952','吴忠市' => '0953','吴忠' => '0953','固原市' => '0954','固原' => '0954','中卫市' => '0955','中卫' => '0955','乌鲁木齐市' => '0991','乌鲁木齐' => '0991','克拉玛依市' => '0992','克拉玛依' => '0992','吐鲁番市' => '0995','吐鲁番' => '0995','吐鲁番地区' => '0995','哈密市' => '0902','哈密' => '0902','哈密地区' => '0902','昌吉回族自治州' => '0994','昌吉' => '0994','昌吉州' => '0994','昌吉自治州' => '0994',
        '博尔塔拉蒙古自治州' => '0909','博尔塔拉' => '0909','博尔塔拉州' => '0909','博尔塔拉自治州' => '0909','巴音郭楞蒙古自治州' => '0996','巴音郭楞' => '0996','巴音郭楞州' => '0996','巴音郭楞自治州' => '0996','阿克苏地区' => '0997','阿克苏' => '0997','克孜勒苏柯尔克孜自治州' => '0997','克孜勒苏柯尔克孜' => '0997','克孜勒苏柯尔克孜州' => '0997','喀什地区' => '0998','和田地区' => '0903','和田' => '0903','伊犁哈萨克自治州' => '0999','伊犁' => '0999','伊犁州' => '0999','伊犁自治州' => '0999','塔城地区' => '0992',
        '塔城' => '0992','阿勒泰地区' => '0906','阿勒泰' => '0906','海东市' => '0972','海东' => '0972','海东地区' => '0972','乐都县' => '0972','海北藏族自治州' => '0970','海北' => '0970','海北州' => '0970','海北自治州' => '0970','黄南藏族自治州' => '0973','黄南' => '0973','黄南州' => '0973','黄南自治州' => '0973','海南藏族自治州' => '0974','海南' => '0974','海南州' => '0974','海南自治州' => '0974','果洛藏族自治州' => '0975','果洛' => '0975',
        '果洛州' => '0975','果洛自治州' => '0975','玉树藏族自治州' => '0976','玉树' => '0976','玉树州' => '0976','玉树自治州' => '0976','海西蒙古族藏族自治州' => '0977','海西' => '0977','海西州' => '0977','海西自治州' => '0977','儋州市' => '0898','儋州' => '0898','河南省直辖县' => '0391', '湖北省直辖县' => '0728', '海南省直辖县' => '0898', '新疆维吾尔自治区直辖县' => '0991', '河北省直辖县' => '0311',
    ];

    static public function analysis(string $str, string $city = ''):array
    {
        $data = [
            'tel' => '',
            'mobile' => ''
        ];

        $arr = [];

        $str = trim($str);
        if (strlen($str) < 18)
        {
            $arr[] = $str;
        }
        else {
            preg_match_all(self::$segmentChar, $str, $matches);
            $match = $matches[0] ?? [];
            if ($match)
            {
                $ret = array_count_values($match);
                $first_value = current($ret);
                if (1 == \count($ret) && 1 == $first_value)
                {
                    $sep = array_search($first_value, $ret);
                } else {
                    logWarning('手机号和固话之前请用单个逗号或者分号分隔', self::$logKey, $str);
                    throw new \InvalidArgumentException('手机号和固话之前请用单个逗号或者分号分隔！', 101300);
                }
            } else {
                if (1 == $str[0]) {
                    $pos = strpos($str, ' ');
                } else {
                    $pos = strrpos($str, ' ');
                }
                $str[$pos] = ',';
                $sep =',';
            }
            $arr = explode($sep, $str);
        }

        if (\count($arr) > 2)
        {
            logWarning('请不要输入超过两个的联系方式', self::$logKey, $str);
            throw new \InvalidArgumentException('请不要输入超过两个的联系方式！', 101301);
        }

        $str1 = array_pop($arr);
        $data = array_merge($data, self::match($str1, $city));

        if ($arr) {
            $str2 = array_pop($arr);
            $data = array_merge($data, self::match($str2, $city));
        }

        if (!($data['tel'] || $data['mobile'])) {
            logWarning('请输入正确的联系方式!', self::$logKey, $str);
            throw new \InvalidArgumentException('请输入正确的联系方式！', 101302);
        }

        return $data;

    }

    static public function match(string $str, string $city = ''):array
    {
        $data = [];
        $first_c = $str[0];
        $three_c = substr($str, 0, 3);

        if ('1' === $first_c) {
            $data['mobile'] = '';
            $mobile = self::hasMobile($str);
            if ($mobile) {
                $data['mobile'] = self::formatMobile($mobile);
            }
        } elseif (\in_array($three_c, ['400', '800'], true)) {
            $phone = self::hasCorp($str);
            if ($phone) {
                $data['tel'] = self::formatCorp($phone);
            }
        } elseif ('0' === $first_c) {
            $phone = self::hasTel($str);
            if ($phone) {
                $data['tel'] = self::formatTel($phone);
            }
        } elseif ($city)
        {
            $code = self::$cityCode[$city];
            $str = $code . $str;
            $phone = self::hasTel($str);
            if ($phone) {
                $data['tel'] = self::formatTel($phone);
            }
        }
        return $data;
    }

    static private function hasMobile(string $str):string
    {
        $pattern = self::$mobilePattern;
        preg_match($pattern, $str, $matches);
        if (isset($matches['phone']) && $matches['phone']) {
            return $matches['phone'];
        }
        return '';
    }

    static private function hasTel(string $str):string
    {
        $pattern02 = self::$telPattern02;
        preg_match($pattern02, $str, $matches02);
        if (isset($matches02['phone']) && $matches02['phone']) {
            return $matches02['phone'];
        }

        $pattern03 = self::$telPattern03;
        preg_match($pattern03, $str, $matches03);
        if (isset($matches03['phone']) && $matches03['phone']) {
            return $matches03['phone'];
        }

        return '';
    }

    static private function hasCorp(string $str):string
    {
        $pattern = self::$corpPattern;
        preg_match($pattern, $str, $matches);
        if (isset($matches['phone']) && $matches['phone']) {
            return $matches['phone'];
        }
        return '';
    }

    static private function formatMobile(string $mobile):string
    {
        return preg_replace("/[^\d]/", '', $mobile);
    }

    static private function formatTel(string $tel):string
    {
        $tel = preg_replace("/[^\d]/", '', $tel);
        $code_n = \in_array($tel[1], [1, 2]) ? 3 : 4;
        $code = substr($tel, 0, $code_n);
        $number_n = self::$telRules[$code] ?? 0;
        if (!\in_array($number_n, [7, 8])) {
            logWarning($code . ' not exist', self::$logKey, $tel);
            throw new \InvalidArgumentException('不存在此电话区号，请核对！', 101303);
        }
        $number = substr($tel, $code_n, $number_n);
        $ret = $code . '-' . $number;
        $code_number = $code_n + $number_n;

        if (strlen($tel) < $code_number) {
            $msg = '区号' . $code . '下固话是' . $number_n . '位，' . $tel . '不符合规则！';
            logWarning($msg, self::$logKey, $tel);
            throw new \InvalidArgumentException($msg, 101304);

        }

        if (strlen($tel) > $code_number) {
            $ret .= '-' . substr($tel, $code_number);
        }
        return $ret;
    }

    static private function formatCorp(string $corp):string
    {
        $corp = preg_replace("/[^\d]/", '', $corp);
        return chunk_split(substr($corp, 0, 6), 3, "-") . substr($corp, 6);
    }
}